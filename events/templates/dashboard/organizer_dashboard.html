{% extends 'dashboard/navigation_bar.html' %}
{% load static %}

{% block events %}
<!-- ✅ Flash Messages -->
{% if messages %}
<div class="max-w-3xl mx-auto mt-6">
  {% for message in messages %}
  <div class="p-3 mb-3 rounded-lg text-center font-medium 
              {% if 'success' in message.tags %}
                  bg-green-100 text-green-700
              {% elif 'error' in message.tags %}
                  bg-red-100 text-red-700
              {% else %}
                  bg-blue-100 text-blue-700
              {% endif %}">
    {{ message }}
  </div>
  {% endfor %}
</div>
{% endif %}

<!-- ✅ Dashboard Header -->
<div class="mt-10 container mx-auto flex flex-col md:flex-row justify-between items-center bg-white shadow-md rounded-xl p-5 border border-gray-100">
  <h1 class="text-2xl font-bold text-gray-800 mb-3 md:mb-0">
    📊 Organizer Dashboard
  </h1>
  <form method="GET" action="{% url 'event-details' %}" class="flex items-center gap-2">
    <input type="text" name="q" value="{{ search_query }}" placeholder="Search Events..."
           class="border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-red-400 w-60">
    <button type="submit"
            class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg shadow transition-all duration-300">
      Search
    </button>
  </form>
</div>

<!-- ✅ Statistics Section -->
<div class="container mx-auto grid lg:grid-cols-4 md:grid-cols-2 grid-cols-1 gap-6 mt-10">
  <a href="{% url 'organizer-dashboard' %}?type=pubs"
     class="bg-white shadow-xl rounded-2xl p-6 text-center hover:shadow-2xl transition-all duration-300 border border-gray-100">
    <h2 class="text-gray-700 font-semibold mb-3">Total Unique Participants</h2>
    <div class="bg-red-500 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-xl font-bold">
      {{ pubs }}
    </div>
  </a>

  <a href="{% url 'organizer-dashboard' %}?type=total"
     class="bg-white shadow-xl rounded-2xl p-6 text-center hover:shadow-2xl transition-all duration-300 border border-gray-100">
    <h2 class="text-gray-700 font-semibold mb-3">Total Events</h2>
    <div class="bg-teal-500 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-xl font-bold">
      {{ counts.total }}
    </div>
  </a>
    <!-- <a href="{% url 'organizer-dashboard' %}?type=upcoming_events">
    <div class="shadow-xl py-5 px-5 text-center">
        <h2 class="text-lg font-bold">Upcoming Events</h2>
        <div class="bg-violet-400 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-lg font-bold">
            <h3>{{ counts.upcoming_events }}</h3>
        </div>
    </div>
  </a>
  <a href="{% url 'organizer-dashboard' %}?type=past_events">
    <div class="shadow-xl py-5 px-5 text-center">
        <h2 class="text-lg font-bold">Past Events</h2>
        <div class="bg-teal-400 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-lg font-bold">
            <h3>{{ counts.past_events }}</h3>
        </div>
    </div>
  </a> -->

  <a href="{% url 'organizer-dashboard' %}?type=upcoming_events"
     class="bg-white shadow-xl rounded-2xl p-6 text-center hover:shadow-2xl transition-all duration-300 border border-gray-100">
    <h2 class="text-gray-700 font-semibold mb-3">Upcoming Events</h2>
    <div class="bg-red-500 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-xl font-bold">
      <h3>{{ counts.upcoming_events }}</h3>
    </div>
  </a>

  <a href="{% url 'organizer-dashboard' %}?type=past_events"
     class="bg-white shadow-xl rounded-2xl p-6 text-center hover:shadow-2xl transition-all duration-300 border border-gray-100">
    <h2 class="text-gray-700 font-semibold mb-3">Past Events</h2>
    <div class="bg-teal-500 w-24 h-24 rounded-full mx-auto flex items-center justify-center text-white text-xl font-bold">
      <h3>{{ counts.past_events }}</h3>
    </div>
  </a>
</div>

<!-- ✅ All Events Section -->
<div class="max-w-5xl mx-auto mt-12 bg-white shadow-2xl rounded-2xl p-6 border border-gray-100">
  <h2 class="text-xl font-semibold bg-gradient-to-r from-red-500 to-red-400 text-white py-3 px-4 rounded-lg shadow mb-6 text-center">
    📅 All Events Listing
  </h2>

  <div class="overflow-x-auto rounded-lg">
    <table class="min-w-full border-collapse">
      <thead class="bg-gradient-to-r from-gray-100 to-gray-200 border-b border-gray-300">
        <tr class="text-left">
          <th class="px-6 py-3 text-gray-700 font-semibold">Event Name</th>
          <th class="px-6 py-3 text-gray-700 font-semibold">Event Date</th>
          <th class="px-6 py-3 text-gray-700 font-semibold">Event Time</th>
        </tr>
      </thead>

      <tbody>
        {% for event in events %}
        <tr class="hover:bg-red-50 transition duration-200 border-b">
          <td class="px-6 py-3">
            <a href="{% url 'event-detail' event.id %}" class="text-red-500 font-medium hover:underline hover:text-red-600">
              {{ event.name }}
            </a>
          </td>
          <td class="px-6 py-3 text-gray-700">{{ event.date }}</td>
          <td class="px-6 py-3 text-gray-700">{{ event.time }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3" class="px-6 py-4 text-center text-gray-500 italic">
            No events available.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>


<!-- ✅ Today's Events -->



<!-- ✅ Today's Events -->
<div class="max-w-6xl mx-auto mt-16 bg-white shadow-2xl rounded-2xl p-8 border border-gray-100">
  <div class="flex justify-between items-center mb-8">
    <h2 class="text-xl font-semibold bg-gradient-to-r from-red-500 to-red-400 text-white py-2 px-4 rounded-lg shadow">
      🌟 Today's Events
    </h2>
  </div>

  {% if events %}
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for event in events %}
      {% if event.date|date:"Y-m-d" == today|date:"Y-m-d" %}
      <div class="bg-white border border-gray-200 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 overflow-hidden">
        <img src="{% static 'images/party.png' %}"
             alt="Event Image"
             class="h-40 w-full object-cover">
        <div class="p-5 text-center">
          <h3 class="text-lg font-semibold text-gray-800 mb-1">{{ event.name }}</h3>
          <p class="text-gray-600 text-sm mb-1"><strong>🕒</strong> {{ event.time }}</p>
          <p class="text-gray-600 text-sm mb-3"><strong>📍</strong> {{ event.location }}</p>
          <a href="{% url 'detail-page' event.id %}">
            <button class="bg-red-500 hover:bg-red-600 text-white text-sm px-4 py-2 rounded-lg transition-all duration-300">
              View Details
            </button>
          </a>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  </div>
  {% else %}
  <p class="text-gray-500 italic text-center mt-4">No events scheduled for today.</p>
  {% endif %}
</div>

{% endblock events %}
